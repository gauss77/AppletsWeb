<?xml version="1.0"?>
<!-- ====================================================================== 
     2006-1-15 23:45:36                                                        

     Packing necessary *.js for net.sf.j2s.lib
                   
     josson smith
     ====================================================================== -->
<project name="j2s.core.build" default="j2s.pack.lib" basedir="..">
    <description>
            Building j2s-core-*.z.js
    </description>
	
	<property name="jcore.src.dir" value="../net.sf.j2s.java.core/src"/>
	<property name="js.src.dir" value="../net.sf.j2s.java.core/bin"/>
	<property name="js.swt.dir" value="../net.sf.j2s.java.org.eclipse.swt"/>
	<property name="js.unit.dir" value="../net.sf.j2s.java.junit"/>
	<property name="jswt.src.dir" value="${js.swt.dir}/bin"/>
	<property name="junit.src.dir" value="${js.unit.dir}/bin"/>
	<property name="ajaxcore.dir" value="../net.sf.j2s.ajax/j2sajax"/>
	<property name="ajax.src.dir" value="../net.sf.j2s.ajax/bin"/>
	<property name="jz.dist.dir" value="j2slib"/>
	<property name="current.project.dir" value="."/>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.core                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.core">
        <java classname="net.sf.j2s.lib.build.SmartJSCompressor">
    		<arg value="${current.project.dir}/${jcore.src.dir}/java/lang/Class.js"/>
        	<arg value="${current.project.dir}/${js.src.dir}/java/lang/Class.js"/>
        	
    		<arg value="no.debug.support=false"/>
    		<arg value="no.javascript.support=true"/>
    		<arg value="link.compress=true"/>

        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
       	</java>

        <java classname="net.sf.j2s.lib.build.SmartJSCompressor">
    		<arg value="${current.project.dir}/${jcore.src.dir}/java/lang/ClassLoader.js"/>
   			<arg value="${current.project.dir}/${js.src.dir}/java/lang/ClassLoader.js"/>
        	
    		<arg value="clazz.existed=true"/>
    		<arg value="no.clazzloader.mode=true"/>
    		<arg value="link.compress=true"/>

        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
       	</java>
    	
        <java classname="net.sf.j2s.lib.build.SmartJSCompressor">
    		<arg value="${current.project.dir}/${js.src.dir}/java/lang/Console.js"/>
    		<arg value="${current.project.dir}/${js.src.dir}/java/lang/Console.js"/>
        	
    		<arg value="no.window.support=false"/>
    		<arg value="no.system.support=false"/>
    		<arg value="link.compress=true"/>

        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
       	</java>
        <concat destfile="${jz.dist.dir}/j2slib.z.js">
            <header filtering="no" trimleading="yes">/******************************************************************************
            	 * Copyright (c) 2005-2006 ognize.com and others.
            	 * All rights reserved. This program and the accompanying materials
            	 * are made available under the terms of the Eclipse Public License v1.0
            	 * which accompanies this distribution, and is available at
            	 * http://www.eclipse.org/legal/epl-v10.html
            	 *
            	 * Web:
            	 *     http://j2s.sourceforge.net/
            	 *     http://sourceforge.net/projects/j2s/
            	 * Contributors:
            	 *     ognize.com - initial API and implementation
            	 *****************************************************************************/
            	/*******
            	 * @author zhou renjian
            	 * @create July 12, 2006
            	 *******/
            </header>
        	<filelist dir="${js.src.dir}">
        		<file name="java/lang/Class.js"/>
        		<file name="java/lang/ClassLoader.js"/>
        		<file name="java/lang/Console.js"/>
        		<!--
        		-->
        	</filelist>
        </concat>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.error                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.error">
        <java classname="net.sf.j2s.lib.build.J2SConcat">
        	<arg value="false"/>
        	<arg value="${js.src.dir}/java/error.z.js"/>
        	
        	<arg value="${current.project.dir}/${js.src.dir}"/>

    		<arg value="java/lang/Throwable.js"/>
    		<arg value="java/lang/StackTraceElement.js"/>
        	
    		<arg value="java/lang/Error.js"/>
        	<arg value="java/lang/LinkageError.js"/>
        	<arg value="java/lang/IncompatibleClassChangeError.js"/>
        	<arg value="java/lang/AbstractMethodError.js"/>
        	<arg value="java/lang/AssertionError.js"/>
        	<arg value="java/lang/ClassCircularityError.js"/>
        	<arg value="java/lang/ClassFormatError.js"/>
        	<arg value="java/lang/ExceptionInInitializerError.js"/>
        	<arg value="java/lang/IllegalAccessError.js"/>
        	<arg value="java/lang/InstantiationError.js"/>
        	<arg value="java/lang/VirtualMachineError.js"/>
        	<arg value="java/lang/InternalError.js"/>
        	<arg value="java/lang/NoClassDefFoundError.js"/>
        	<arg value="java/lang/NoSuchFieldError.js"/>
        	<arg value="java/lang/NoSuchMethodError.js"/>
        	<arg value="java/lang/OutOfMemoryError.js"/>
        	<arg value="java/lang/StackOverflowError.js"/>
        	<arg value="java/lang/UnknownError.js"/>
        	<arg value="java/lang/UnsatisfiedLinkError.js"/>
        	<arg value="java/lang/UnsupportedClassVersionError.js"/>
        	<arg value="java/lang/VerifyError.js"/>
        	<arg value="java/lang/ThreadDeath.js"/>

    		<arg value="java/lang/Exception.js"/>
        	<arg value="java/lang/RuntimeException.js"/>
        	<arg value="java/lang/ArithmeticException.js"/>
        	<arg value="java/lang/IndexOutOfBoundsException.js"/>
        	<arg value="java/lang/ArrayIndexOutOfBoundsException.js"/>
        	<arg value="java/lang/ArrayStoreException.js"/>
        	<arg value="java/lang/ClassCastException.js"/>
        	<arg value="java/lang/ClassNotFoundException.js"/>
        	<arg value="java/lang/CloneNotSupportedException.js"/>
        	<arg value="java/lang/IllegalAccessException.js"/>
        	<arg value="java/lang/IllegalArgumentException.js"/>
        	<arg value="java/lang/IllegalMonitorStateException.js"/>
        	<arg value="java/lang/IllegalStateException.js"/>
        	<arg value="java/lang/IllegalThreadStateException.js"/>
        	<arg value="java/lang/InstantiationException.js"/>
        	<arg value="java/lang/InterruptedException.js"/>
        	<arg value="java/lang/NegativeArraySizeException.js"/>
        	<arg value="java/lang/NoSuchFieldException.js"/>
        	<arg value="java/lang/NoSuchMethodException.js"/>
        	<arg value="java/lang/NullPointerException.js"/>
        	<arg value="java/lang/NumberFormatException.js"/>
        	<arg value="java/lang/SecurityException.js"/>
        	<arg value="java/lang/StringIndexOutOfBoundsException.js"/>
        	<arg value="java/lang/UnsupportedOperationException.js"/>

        	<arg value="java/lang/reflect/InvocationTargetException.js"/>
        	<arg value="java/lang/reflect/UndeclaredThrowableException.js"/>

        	<arg value="java/io/IOException.js"/>
        	<arg value="java/io/CharConversionException.js"/>
        	<arg value="java/io/EOFException.js"/>
        	<arg value="java/io/FileNotFoundException.js"/>
        	<arg value="java/io/InterruptedIOException.js"/>
        	<arg value="java/io/ObjectStreamException.js"/>
        	<arg value="java/io/InvalidClassException.js"/>
        	<arg value="java/io/InvalidObjectException.js"/>
        	<arg value="java/io/NotActiveException.js"/>
        	<arg value="java/io/NotSerializableException.js"/>
        	<arg value="java/io/OptionalDataException.js"/>
        	<arg value="java/io/StreamCorruptedException.js"/>
        	<arg value="java/io/SyncFailedException.js"/>
        	<arg value="java/io/UnsupportedEncodingException.js"/>
        	<arg value="java/io/UTFDataFormatException.js"/>
        	<arg value="java/io/WriteAbortedException.js"/>

        	<arg value="java/util/ConcurrentModificationException.js"/>
        	<arg value="java/util/EmptyStackException.js"/>
        	<arg value="java/util/MissingResourceException.js"/>
        	<arg value="java/util/NoSuchElementException.js"/>
        	<arg value="java/util/TooManyListenersException.js"/>

        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
        </java>
    </target>
	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.common                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.common" depends="j2s.pack.prepare">
        <java classname="net.sf.j2s.lib.build.J2SConcat">
        	<arg value="false"/>
        	<arg value="${js.src.dir}/java/core.z.js"/>
        	
        	<arg value="${current.project.dir}/${js.src.dir}"/>

        	<!-- Already defined in Class.js
    		<arg value="java/io/Serializable.js"/>
    		<arg value="java/lang/CharSequence.js"/>
    		<arg value="java/lang/Cloneable.js"/>
    		<arg value="java/lang/Comparable.js"/>
    		<arg value="java/lang/Runnable.js"/>
    		<arg value="java/util/Comparator.js"/>
    		-->
    		
    		<arg value="java/lang/Number.js"/>
    		<arg value="java/lang/Integer.js"/>
    		<arg value="java/lang/Long.js"/>
    		<arg value="java/lang/Float.js"/>
    		<arg value="java/lang/Double.js"/>
    		
    		<arg value="java/lang/Encoding.js"/>
    		<arg value="java/lang/String.js"/>
    			
    		<arg value="java/util/Date.js"/>
    		
    		<arg value="java/util/EventObject.js"/>
    		<arg value="java/util/EventListener.js"/>
    		<arg value="java/util/EventListenerProxy.js"/>
    		
    		<arg value="java/util/Iterator.js"/>
    		<arg value="java/util/ListIterator.js"/>
    		<arg value="java/util/Enumeration.js"/>
    		<arg value="java/util/Collection.js"/>
    		<arg value="java/util/Set.js"/>
    		<arg value="java/util/Map.js"/>
    		<arg value="java/util/List.js"/>
    		<arg value="java/util/RandomAccess.js"/>

        	<!--
    		<file name="net/sf/j2s/ajax/HttpRequest.js"/>
    		<file name="net/sf/j2s/ajax/IXHRCallback.js"/>
    		<file name="net/sf/j2s/ajax/XHRCallbackAdapter.js"/>
    		<file name="net/sf/j2s/ajax/XHRCallbackSWTAdapter.js"/>
			-->
        	
        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
        </java>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.lib                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.lib" depends="j2s.pack.core,j2s.pack.common,j2s.pack.error,j2s.pack.swt">
    	<copy todir="${jz.dist.dir}">
    		<fileset dir="${ajax.src.dir}">
    			<exclude name="**/*.clazz"/>
    			<exclude name="**/*.class"/>
    			<exclude name="**/AjaxPlugin.js"/>
    			<exclude name="**/AJAXVariableInitializer.js"/>
    			<exclude name="**/*.swp"/>
    			<exclude name="**/*.swo"/>
    		</fileset>
    		<fileset dir="${js.src.dir}">
    			<exclude name="**/*.clazz"/>
    			<exclude name="**/*.class"/>
    			<exclude name="**/*.swp"/>
    			<exclude name="**/*.swo"/>
    		</fileset>
    		<fileset dir="${jswt.src.dir}">
    			<exclude name="org/eclipse/swt/internal/xhtml/**"/>
    			<exclude name="**/*.clazz"/>
    			<exclude name="**/*.class"/>
    			<exclude name="**/*.swp"/>
    			<exclude name="**/*.swo"/>
    		</fileset>
    		<fileset dir="${junit.src.dir}">
    			<exclude name="**/*.clazz"/>
    			<exclude name="**/*.class"/>
    			<exclude name="**/*.swp"/>
    			<exclude name="**/*.swo"/>
    		</fileset>
    	</copy>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.zip                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.zip" depends="j2s.pack.lib">
    	<zip destfile="j2slib.zip">
    		<fileset dir=".">
    			<include name="j2slib/**"/>
    			<exclude name="**/*.swp"/>
    			<exclude name="**/*.swo"/>
    			<exclude name="**/*.tmp"/>
    			<exclude name="**/*.svn"/>
    		</fileset>
    	</zip>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.unzip                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.unzip">
    	<unzip dest="." src="j2slib.zip"></unzip>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.prepare                     
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.prepare" depends="j2s.pack.core">
    	<mkdir dir="j2slib"/>
    	
    	<delete file="${ajax.src.dir}/net/sf/j2s/ajax/HttpRequest.js" quiet="true"/>
        	
        <java classname="net.sf.j2s.lib.build.RegExCompress">
        	<arg value="false"/>
        	<arg value="${current.project.dir}"/>

    		<arg value="${ajaxcore.dir}/HttpRequest.js"/>
    		<arg value="${ajax.src.dir}/net/sf/j2s/ajax/HttpRequest.js"/>

        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
        </java>
    </target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: j2s.pack.swt                      
         - - - - - - - - - - - - - - - - - -->
    <target name="j2s.pack.swt" depends="pack.swt.basic,pack.swt.more,pack.swt.event,pack.swt.css">
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: pack.swt.css                     
         - - - - - - - - - - - - - - - - - -->
    <target name="pack.swt.css">
        <java classname="net.sf.j2s.lib.build.PackCSSIntoJS">
        	<arg value="${jswt.src.dir}/"/>
        	
        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
        </java>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: pack.swt.widgets.css                     
         - - - - - - - - - - - - - - - - - -->
    <target name="pack.swt.widgets.css">
        <concat destfile="${jswt.src.dir}/org/eclipse/swt/widgets/package.css">
        	<fileset dir="${jswt.src.dir}/org/eclipse/swt/widgets/">
        	    <include name="*.css"/>
        	</fileset>
        </concat>
	</target>

    <!-- ================================= 
          target: pack.swt.basic              
         ================================= -->
    <target name="pack.swt.basic" description="Building j2s-swt-*.z.js">
        <concat destfile="${jswt.src.dir}/org/eclipse/swt/basic.z.js">
        	<filelist dir="${jswt.src.dir}">
        		<!--
        		<file name="org/eclipse/swt/SWT.js"/>
        		<file name="org/eclipse/swt/SWTError.js"/>
           		<file name="org/eclipse/swt/SWTException.js"/>
        		
        		<file name="org/eclipse/swt/internal/SWTEventListener.js"/>
        		<file name="org/eclipse/swt/internal/SWTEventObject.js"/>
        		-->
        		<file name="org/eclipse/swt/internal/SerializableCompatibility.js"/>
        		<file name="org/eclipse/swt/internal/CloneableCompatibility.js"/>
        		<file name="org/eclipse/swt/internal/RunnableCompatibility.js"/>
        		
        		<file name="org/eclipse/swt/internal/dnd/HTMLEventWrapper.js"/>
        		<file name="org/eclipse/swt/internal/dnd/DragListener.js"/>
        		<file name="org/eclipse/swt/internal/dnd/DragAdapter.js"/>
        		<file name="org/eclipse/swt/internal/dnd/DragEvent.js"/>
        		
        		<file name="org/eclipse/swt/internal/struct/WINDOWPOS.js"/>
        		<file name="org/eclipse/swt/internal/struct/MESSAGE.js"/>
        		
        		<file name="org/eclipse/swt/accessibility/Accessible.js"/>

        		<file name="org/eclipse/swt/graphics/Point.js"/>
        		<file name="org/eclipse/swt/graphics/Rectangle.js"/>
        		<file name="org/eclipse/swt/graphics/RGB.js"/>
        		
        		<!--
        		<file name="org/eclipse/swt/graphics/GC.js"/>
        		-->

        		<file name="org/eclipse/swt/graphics/Resource.js"/>
        		<file name="org/eclipse/swt/graphics/Color.js"/>
        		<file name="org/eclipse/swt/graphics/Cursor.js"/>

        		<file name="org/eclipse/swt/graphics/Drawable.js"/>
        		<file name="org/eclipse/swt/graphics/Device.js"/>
        		<file name="org/eclipse/swt/graphics/DeviceData.js"/>

        		<file name="org/eclipse/swt/widgets/Monitor.js"/>

        		<!--
        		<file name="org/eclipse/swt/graphics/ImageData.js"/>
        		<file name="org/eclipse/swt/graphics/ImageLoader.js"/>
        		<file name="org/eclipse/swt/graphics/Image.js"/>

        		<file name="org/eclipse/swt/graphics/Font.js"/>
        		<file name="org/eclipse/swt/graphics/FontData.js"/>
        		<file name="org/eclipse/swt/graphics/FontMetrics.js"/>
        		-->

        	</filelist>
        </concat>
    </target>

    <!-- ================================= 
          target: pack.swt.more              
         ================================= -->
    <target name="pack.swt.more" description="Building j2s-swt-*.z.js">
        <concat destfile="${jswt.src.dir}/org/eclipse/swt/more.z.js">
        	<filelist dir="${jswt.src.dir}">
    			<file name="org/eclipse/swt/internal/ResizeHandler.js"/>
        		<file name="org/eclipse/swt/internal/ResizeSystem.js"/>

        		<file name="org/eclipse/swt/internal/dnd/DragAndDrop.js"/>
        		<file name="org/eclipse/swt/internal/dnd/DNDUtils.js"/>
        		<file name="org/eclipse/swt/internal/dnd/ShellFrameDND.js"/>
        		<!--
        		-->
        		<file name="org/eclipse/swt/internal/browser/OS.js"/>
        		
        		<file name="org/eclipse/swt/graphics/Image.js"/>

        		<file name="org/eclipse/swt/widgets/Item.js"/>
        		<file name="org/eclipse/swt/widgets/Layout.js"/>
        		<!--
        		<file name="org/eclipse/swt/graphics/ImageData.js"/>
        		<file name="org/eclipse/swt/graphics/ImageLoader.js"/>

        		<file name="org/eclipse/swt/graphics/Font.js"/>
        		<file name="org/eclipse/swt/graphics/FontData.js"/>
        		<file name="org/eclipse/swt/graphics/FontMetrics.js"/>
        		-->

        	</filelist>
        </concat>
    </target>

    <!-- ================================= 
          target: pack.swt.event              
         ================================= -->
    <target name="pack.swt.event" description="Building j2s-swt-*.z.js">
        <concat destfile="${jswt.src.dir}/org/eclipse/swt/events.z.js">
            <header filtering="no" trimleading="yes">/*-# 
            	# ["$wt.events.TypedEvent"] -> t$e
            	# ["$wt.internal.SWTEventListener"] -> e$l
            	#-*/
            </header>
        	<filelist dir="${jswt.src.dir}">
        		<file name="org/eclipse/swt/internal/SWTEventListener.js"/>
        		<file name="org/eclipse/swt/internal/SWTEventObject.js"/>
        		
        		<file name="org/eclipse/swt/widgets/Event.js"/>
        		<file name="org/eclipse/swt/events/TypedEvent.js"/>
        	
        		<file name="org/eclipse/swt/events/ArmEvent.js"/>
        		<file name="org/eclipse/swt/events/ControlEvent.js"/>
        		<file name="org/eclipse/swt/events/DisposeEvent.js"/>
        		<file name="org/eclipse/swt/events/FocusEvent.js"/>
        		<file name="org/eclipse/swt/events/HelpEvent.js"/>
        		<file name="org/eclipse/swt/events/KeyEvent.js"/>
        		<file name="org/eclipse/swt/events/MenuEvent.js"/>
        		<file name="org/eclipse/swt/events/ModifyEvent.js"/>
        		<file name="org/eclipse/swt/events/MouseAdapter.js"/>
        		<file name="org/eclipse/swt/events/MouseEvent.js"/>
        		<file name="org/eclipse/swt/events/PaintEvent.js"/>
        		<file name="org/eclipse/swt/events/SelectionEvent.js"/>
        		<file name="org/eclipse/swt/events/ShellEvent.js"/>
        		<file name="org/eclipse/swt/events/TraverseEvent.js"/>
        		<file name="org/eclipse/swt/events/TreeEvent.js"/>
        		<file name="org/eclipse/swt/events/VerifyEvent.js"/>
        		
        		<file name="org/eclipse/swt/widgets/Listener.js"/>
        		<file name="org/eclipse/swt/widgets/TypedListener.js"/>

        		<file name="org/eclipse/swt/events/ArmListener.js"/>
        		<file name="org/eclipse/swt/events/ControlListener.js"/>
        		<file name="org/eclipse/swt/events/ControlAdapter.js"/>
        		<file name="org/eclipse/swt/events/DisposeListener.js"/>
        		<file name="org/eclipse/swt/events/FocusListener.js"/>
        		<file name="org/eclipse/swt/events/FocusAdapter.js"/>
        		<file name="org/eclipse/swt/events/HelpListener.js"/>
        		<file name="org/eclipse/swt/events/KeyListener.js"/>
        		<file name="org/eclipse/swt/events/KeyAdapter.js"/>
        		<file name="org/eclipse/swt/events/MenuListener.js"/>
        		<file name="org/eclipse/swt/events/MenuAdapter.js"/>
        		<file name="org/eclipse/swt/events/ModifyListener.js"/>
        		<file name="org/eclipse/swt/events/MouseListener.js"/>
        		<file name="org/eclipse/swt/events/MouseMoveListener.js"/>
        		<file name="org/eclipse/swt/events/MouseTrackListener.js"/>
        		<file name="org/eclipse/swt/events/MouseTrackAdapter.js"/>
        		<file name="org/eclipse/swt/events/PaintListener.js"/>
        		<file name="org/eclipse/swt/events/SelectionListener.js"/>
        		<file name="org/eclipse/swt/events/SelectionAdapter.js"/>
        		<file name="org/eclipse/swt/events/ShellListener.js"/>
        		<file name="org/eclipse/swt/events/ShellAdapter.js"/>
        		<file name="org/eclipse/swt/events/TraverseListener.js"/>
        		<file name="org/eclipse/swt/events/TreeListener.js"/>
        		<file name="org/eclipse/swt/events/TreeAdapter.js"/>
        		<file name="org/eclipse/swt/events/VerifyListener.js"/>

        		<file name="org/eclipse/swt/widgets/EventTable.js"/>
        	</filelist>
        </concat>
        <java classname="net.sf.j2s.lib.build.SmartJSCompressor">
    		<arg value="${current.project.dir}/${jswt.src.dir}/org/eclipse/swt/events.z.js"/>
    		<arg value="${current.project.dir}/${jswt.src.dir}/org/eclipse/swt/events.js"/>
        	
        	<classpath>
        		<pathelement path="bin"/>
        	</classpath>
       	</java>
        <concat destfile="${jswt.src.dir}/org/eclipse/swt/events.z.js">
            <header filtering="no" trimleading="yes">
            	var t$e = ["$wt.events.TypedEvent"];
            	var e$l = ["$wt.internal.SWTEventListener"];
            </header>
        	<filelist dir="${jswt.src.dir}">
        		<file name="org/eclipse/swt/events.js"/>
        	</filelist>
        </concat>
    	<delete file="${jswt.src.dir}/org/eclipse/swt/events.js"></delete>
    </target>

</project>

